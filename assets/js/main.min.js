function generateTableRow(){var e=document.createElement("tr");return e.innerHTML='<td><a class="cut">-</a><span contenteditable></span></td><td><span contenteditable></span></td><td><span data-prefix>$</span><span contenteditable>0.00</span></td><td><span contenteditable>0</span></td><td><span data-prefix>$</span><span>0.00</span></td>',e}function parseFloatHTML(e){return parseFloat(e.innerHTML.replace(/[^\d\.\-]+/g,""))||0}function parsePrice(e){return e.toFixed(2).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1,")}function updateNumber(e){var t=document.activeElement,r=parseFloat(t.innerHTML),n=t.innerHTML==parsePrice(parseFloatHTML(t));!isNaN(r)&&(38==e.keyCode||40==e.keyCode||e.wheelDeltaY)&&(e.preventDefault(),r+=38==e.keyCode?1:40==e.keyCode?-1:Math.round(.025*e.wheelDelta),r=Math.max(r,0),t.innerHTML=n?parsePrice(r):r),updateInvoice()}function updateInvoice(){for(var e,t,r,n,a,r=0,n=document.querySelectorAll("table.inventory tbody tr"),a=0;n[a];++a)r+=t=parseFloatHTML((e=n[a].querySelectorAll("span:last-child"))[2])*parseFloatHTML(e[3]),e[4].innerHTML=t;(e=document.querySelectorAll("table.balance td:last-child span:last-child"))[0].innerHTML=r,e[2].innerHTML=document.querySelector("table.meta tr:last-child td:last-child span:last-child").innerHTML=parsePrice(r-parseFloatHTML(e[1]));var o=document.querySelector("#prefix").innerHTML;for(n=document.querySelectorAll("[data-prefix]"),a=0;n[a];++a)n[a].innerHTML=o;for(n=document.querySelectorAll("span[data-prefix] + span"),a=0;n[a];++a)document.activeElement!=n[a]&&(n[a].innerHTML=parsePrice(parseFloatHTML(n[a])))}function onContentLoad(){updateInvoice();var e=document.querySelector("input"),t=document.querySelector("img");function r(e){e.preventDefault(),t.classList.add("hover")}function n(e){e.preventDefault(),t.classList.remove("hover")}function a(e){t.classList.remove("hover");var r=new FileReader,n=e.dataTransfer?e.dataTransfer.files:e.target.files,a=0;for(r.onload=o;n[a];)r.readAsDataURL(n[a++])}function o(e){var r=e.target.result;t.src=r}window.addEventListener&&(document.addEventListener("click",function e(t){var r,n=t.target.querySelector("[contenteditable]");n&&t.target!=document.documentElement&&t.target!=document.body&&n.focus(),t.target.matchesSelector(".add")?document.querySelector("table.inventory tbody").appendChild(generateTableRow()):"cut"==t.target.className&&(r=t.target.ancestorQuerySelector("tr")).parentNode.removeChild(r),updateInvoice()}),document.addEventListener("mousewheel",updateNumber),document.addEventListener("keydown",updateNumber),document.addEventListener("keydown",updateInvoice),document.addEventListener("keyup",updateInvoice),e.addEventListener("focus",r),e.addEventListener("mouseover",r),e.addEventListener("dragover",r),e.addEventListener("dragenter",r),e.addEventListener("blur",n),e.addEventListener("dragleave",n),e.addEventListener("mouseout",n),e.addEventListener("drop",a),e.addEventListener("change",a))}!function(e){for(var t,r=e.head=e.getElementsByTagName("head")[0]||e.documentElement,n="article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output picture progress section summary time video x".split(" "),a=n.length,o=0;o<a;)t=e.createElement(n[++o]);t.innerHTML="x<style>article,aside,details,figcaption,figure,footer,header,hgroup,nav,section{display:block}audio[controls],canvas,video{display:inline-block}[hidden],audio{display:none}mark{background:#FF0;color:#000}</style>",r.insertBefore(t.lastChild,r.firstChild)}(document),function(e,t,r,n){function a(){}a.prototype.length=r.length,t.matchesSelector=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function e(t){return r.indexOf.call(this.parentNode.querySelectorAll(t),this)>-1},t.ancestorQuerySelectorAll=t.ancestorQuerySelectorAll||t.mozAncestorQuerySelectorAll||t.msAncestorQuerySelectorAll||t.oAncestorQuerySelectorAll||t.webkitAncestorQuerySelectorAll||function e(t){for(var n=this,o=new a;n=n.parentElement;)n.matchesSelector(t)&&r.push.call(o,n);return o},t.ancestorQuerySelector=t.ancestorQuerySelector||t.mozAncestorQuerySelector||t.msAncestorQuerySelector||t.oAncestorQuerySelector||t.webkitAncestorQuerySelector||function e(t){return this.ancestorQuerySelectorAll(t)[0]||null}}(this,Element.prototype,Array.prototype),window.addEventListener&&document.addEventListener("DOMContentLoaded",onContentLoad);